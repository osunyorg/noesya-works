// TODO: ceci est un quickfix, il faut repasser sur l'inté des blocks pour vérifier les alignements verticaux
.block
    margin-top: 0
    margin-bottom: 0
    padding-top: $spacing-5
    padding-bottom: $spacing-5
    
.block-testimonials
    @include media-breakpoint-up(desktop)
        .block-title,
        blockquote
            text-align: center
        figcaption
            justify-content: center
            p
                width: auto


// Blocks
.block-image, 
.block-gallery
    figcaption
        bottom: 0
        font-size: 0
        position: absolute
        transform: translateY(100%)
        right: 0
    @include in-page-without-sidebar
        .block-content figure
            background: $color-background-alt
            display: block
            picture
                margin: 0
                width: 100%
            @include media-breakpoint-up(desktop)
                picture img
                    margin: auto
                    max-height: unset
                figcaption
                    font-size: 0

.block-image 
    @include in-page-without-sidebar
        picture
            padding-bottom: offset(2)
            padding-top: offset(2)
        figure img
            margin-bottom: 0
            margin-left: $spacing-1
            margin-right: $spacing-1
            width: calc(100% - #{var(--grid-gutter)})
            @include media-breakpoint-up(desktop)
                width: columns(8)
            @include media-breakpoint-down(desktop)
                padding-bottom: $spacing-1
                padding-top: $spacing-1
.block-gallery 
    @include in-page-with-or-without-sidebar
        .gallery
            @include grid(2, desktop)
            align-items: inherit
            figure
                padding-bottom: columns(2)
                padding-top: columns(2)
                &::after
                    display: none
                img
                    margin-bottom: 0
                &.cover
                    // Remove strange grey area at the bottom on mobile
                    line-height: 0
                    figcaption
                        // TODO @alex en fait c'est pas ça qu'il faut faire, c'est virer les [full] avec Hugo
                        // cf https://github.com/noesya/coop.noesya.works/issues/1
                        display: none
            @include media-breakpoint-up(desktop)
                figure.cover
                    position: relative
                    picture
                        bottom: 0
                        left: 0
                        height: 100%
                        position: absolute
                        right: 0
                        top: 0
                        img
                            height: 100%
                            object-fit: cover
                            width: 100%
                figure:not(.cover) picture
                    margin-left: auto
                    margin-right: auto
                    width: columns(2.65) // TODO CHECK
            @include media-breakpoint-up(xxl)
                figure:not(.cover) picture
                    width: columns(2.85) // TODO CHECK
            @include media-breakpoint-down(desktop)
                display: block
                figure
                    padding: $spacing-5
                    &.cover
                        padding: 0 !important
                        picture 
                            height: 100%
                            img
                                display: initial
                                height: 100%
                    &:not(.cover) 
                        padding-bottom: $spacing-5
                        padding-top: $spacing-5
                        picture
                            margin-left: auto
                            margin-right: auto
                            width: fit-content
                        + figure:not(.cover)
                            padding-top: 0

.block-gallery + .block-image,
.block-image + .block-gallery
    padding-top: 0
    @include media-breakpoint-down(desktop)
    margin-top: -$spacing-5
@include media-breakpoint-up(desktop)
    .block-image + .block-gallery
        margin-top: -54px

.block-organizations,
.block-persons
    .top
        .block-title
            text-align: center

// .block-persons
//     @include media-breakpoint-down(desktop)
//         .persons
//             gap: calc(#{$spacing-3} + #{$spacing-2})
//     @include media-breakpoint-up(desktop)
//         .top
//             margin-bottom: $spacing-6
//         .avatar
//             width: columns(3)
//         @include in-page-with-or-without-sidebar
//             .persons
//                 @include grid(3, desktop)
//             .avatar
//                 width: columns(3)
//                 margin-bottom: 0
//             .description + .avatar
//                 margin-right: $spacing-3
//     .person
//         align-items: center
//         flex-direction: row 
//         .description
//             text-align: left

.block-organizations
    .media
        background: none
    .organizations
        display: flex !important
        justify-content: center
        column-gap: var(--grid-gutter)
        flex-wrap: wrap
        row-gap: half(var(--grid-gutter))
        .organization
            width: columns(6)
            .organization-title
                @extend .sr-only
            @include media-breakpoint-up(desktop)
                width: columns(2)

.block-chapter
    &--no_background 
        .block-title
            @include h2

    .chapter
        @include in-page-with-or-without-sidebar
            @include media-breakpoint-up(desktop)
                .text
                    display: flex
                    width: 100%
                    gap: var(--grid-gutter)
                    .top 
                        width: columns(6)
                        + * 
                            width: columns(6)
    &.block-chapter--alt_background 
    &.block-chapter--alt_background 
        background: none
        .text
            @include in-page-with-or-without-sidebar
                display: block
                text-align: center
                .top, 
                .rich-text
                    width: 100%
                .top
                    margin-bottom: $spacing-6
                p + p 
                    margin-top: $spacing-2
                @include media-breakpoint-down(desktop)
                    margin-bottom: $spacing-5

.block-call_to_action
    overflow: hidden
    position: relative
    figcaption
        @extend .sr-only
    @include media-breakpoint-down(desktop)
        padding-top: 0
        padding-bottom: var(--grid-gutter)
        .container
            figure
                margin-bottom: var(--grid-gutter)
            picture
                margin-left: var(--grid-gutter-negative)
                margin-right: var(--grid-gutter-negative)
            .call_to_action
                padding-top: 0
                padding-bottom: 0
                > div
                    .actions
                        display: flex
                        justify-content: center
                        a:first-child
                            margin-right: 0
                            margin-top: 0
    @include in-page-without-sidebar
        .block-content
            padding-top: $spacing-6
            padding-bottom: $spacing-6
            @include media-breakpoint-up(desktop)
                padding-top: $spacing-7
                padding-bottom: $spacing-7
        .call_to_action--with-image
            display: flex
            justify-content: center
            @include media-breakpoint-down(desktop)
                padding-top: $spacing-5
            figure
                bottom: 0
                left: 0
                position: absolute
                top: 0
                right: 0
                margin-bottom: 0
                figcaption
                    display: none // credits are display above the cta
                img
                    height: 100%
                    object-fit: cover
                    object-position: top
                    width: 100%
        .actions 
            margin-top: 0
            position: relative
            text-align: center
            z-index: 2
            a
                @include hover-translate-icon
                @include icon(arrow-right-line, after)
                display: flex
                align-items: center
                margin: 0
                &:focus-visible
                    outline-color: $block-call-to-action-accent-button-hover-background
                &::after
                    margin-left: $spacing-2
.block-posts--list
    @include in-page-without-sidebar
        @include media-breakpoint-up(desktop)
            .post
                .post-content
                    margin-left: 0
                .media
                    pointer-events: none
                    opacity: 0
                    position: absolute
                    top: 50%
                    left: 50%
                    transform: translate(-50%, -50%)
                    transition: opacity .2s ease
                    width: columns(2)
                    z-index: 100
                &:hover
                    .media
                        opacity: 1